<!DOCTYPE html>
<html dir="ltr" lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="referrer" content="no-referrer">
  <title>å°ç­æ•°æ®ç®¡ç†</title>
  <link rel="shortcut icon" href="favicon.ico">
  <link rel="apple-touch-icon" href="favicon.ico">
  <link rel="stylesheet" href="lib/style.css">
  <style>
    /* #group-page {
      z-index: 1;
    }

    #data-page {
      z-index: 2;
    }

    #setting-page {
      z-index: 3;
    } */
  </style>
</head>

<body class="outside-bg">
  <div class="bg-items">
    <span class="high-grass grass-border">
      <span></span><span></span><span></span><span></span><span></span>
    </span>
    <span class="high-grass">
      <span></span><span></span><span></span><span></span><span></span>
    </span>
    <span class="low-grass grass-border">
      <span></span><span></span><span></span><span></span><span></span>
    </span>
    <span class="low-grass">
      <span></span><span></span><span></span><span></span><span></span>
    </span>
    <div id="cloud_container">
    </div>
  </div>
  <main>
    <div class="wall notice-wall">
    </div>
    <div class="wall" style="width: 75%;">
      <div class="eaves">
        <div class="gloss"></div>
        <div class="eaves-container">
          <div class="back-button btn" onclick="SwitchPop()">â—ã€€</div>
          <a id="group_button" onclick="groupPage()">å°ç­åˆ—è¡¨</a>
          <a id="data_button" onclick="dataPage()">æ•°æ®æŸ¥è¯¢</a>
          <a id="setting_button" onclick="settingPage()">ç³»ç»Ÿè®¾ç½®</a>
          <a id="strategy_button" onclick="strategyPage()">ç¼–è¾‘ç­–ç•¥</a>
        </div>
      </div>
      <div class="wall-container group-page hide" id="group-page">
        
        <span class="loading-text hide">
          <div class="loader">
            <span></span>
            <span></span>
            <span></span>
          </div>
          æ•°æ®è·å–ä¸­ï¼Œè¯·ç¨å...
        </span>
        <div id="group_filter" class="search-input">
          <span>ğŸ”</span>
          <input type="text" placeholder="ç­›é€‰å°ç­" onkeyup="groupFilter(event)">
        </div>
        <div class="group empty-group" onclick="toggleGroupSearchModal()">
        </div>
      </div>
      <div class="wall-container data-page hide" id="data-page">
        
        <span class="loading-text">
          <div class="loader">
            <span></span>
            <span></span>
            <span></span>
          </div>
          æ•°æ®è·å–ä¸­ï¼Œè¯·ç¨å...
        </span>
        <div class="blackboard hide">
          <span class="gloss"></span>
          <span class="eraser" onclick="slideLeft(event)"></span>
          <span id="status_text">
          </span>
        </div>
        <div class="data-container hide">
          <div class="input-group">
            <div class="input">
              <label for="group_id_select">å°ç­ID</label>
              <select id="group_id_select" onkeyup="eventSearch(event)">
                <option value="">ä»»æ„å°ç­</option>
              </select>
            </div>
            <div class="input">
              <label for="group_name_input">å°ç­åç§°</label>
              <input id="group_name_input" type="text" onkeyup="eventSearch(event)" />
            </div>
            <div class="input">
              <label for="sdate_select">å¼€å§‹æ—¥æœŸ</label>
              <input id="sdate_select" type="date" onkeyup="eventSearch(event)" />
            </div>
            <div class="input">
              <label for="edate_select">ç»“æŸæ—¥æœŸ</label>
              <input id="edate_select" type="date" onkeyup="eventSearch(event)" />
            </div>
            <div class="input">
              <label for="cheat_select">æ˜¯å¦ä½œå¼Š</label>
              <select id="cheat_select" onkeyup="eventSearch(event)">
                <option value="">ä»»æ„</option>
                <option value="true">æ˜¯</option>
                <option value="false">å¦</option>
              </select>
            </div>
            <div class="input">
              <label for="completed_time_select">æ‰“å¡æ™šäº</label>
              <input id="completed_time_select" type="time" onkeyup="eventSearch(event)" />
            </div>
            <div class="input">
              <label for="user_id_input">ç”¨æˆ·ID</label>
              <input id="user_id_input" type="number" onkeyup="eventSearch(event)" />
            </div>
            <div class="input">
              <label for="nickname_input">ç”¨æˆ·æ˜µç§°</label>
              <input id="nickname_input" type="text" onkeyup="eventSearch(event)" />
            </div>
            <div class="btn-group">
              <div id="reset_btn" class="btn" onclick="resetSearch()">é‡ç½®</div>
              <div id="search_btn" class="btn" onclick="queryMemberTable()">æŸ¥è¯¢</div>
              <div id="download_btn" class="btn" onclick="downloadMemberTable(event)">ä¸‹è½½</div>
            </div>
          </div>
          <div class="table">
            <div class="table-page">
              <div class="page-button">
                <div class="btn" onclick="queryMemberTable('1')">&lt;&lt;</div>
                <div class="btn" onclick="queryMemberTable('-')">&lt;</div>
                <div class="page-count">0/0</div>
                <div class="btn" onclick="queryMemberTable('+')">&gt;</div>
                <div class="btn" onclick="queryMemberTable('-1')">&gt;&gt;</div>
              </div>
              <select id="page_count">
                <option value="20">20æ¡/é¡µ</option>
                <option value="50">50æ¡/é¡µ</option>
                <option value="100">100æ¡/é¡µ</option>
                <option value="200">200æ¡/é¡µ</option>
                <option value="500">500æ¡/é¡µ</option>
                <option value="2000">2000æ¡/é¡µ</option>
              </select>
            </div>
            <div class="table-content">
              <table id="user_info_table">
              </table>
            </div>
          </div>
        </div>
      </div>
      <div class="wall-container setting-page hide" id="setting-page">
        
        <span class="loading-text">
          <div class="loader">
            <span></span>
            <span></span>
            <span></span>
          </div>
          æ•°æ®è·å–ä¸­, è¯·ç¨å...
        </span>
        <div class="container hide">
          <div class="setting-group">
            <div class="input">
              <label for="cache_second_input">æ•°æ®ç¼“å­˜æ—¶é•¿</label>
              <input id="cache_second_input" type="number" />
            </div>
            <span class="setting-desc">åœ¨[æ•°æ®æŸ¥è¯¢]é¡µé¢æŸ¥è¯¢æ—¶, æœ¬ç¨‹åºä¼šå¯¹ä»Šæ—¥æ•°æ®è¿›è¡Œä¸€æ¬¡æŸ¥è¯¢, ä¸ºå‡å°‘ä¸å¿…è¦çš„è¯·æ±‚å¯¹æºæ•°æ®æœåŠ¡å™¨é€ æˆè´Ÿæ‹…, è®¾ç½®æ•°æ®ç¼“å­˜æ—¶é•¿ï¼ˆå•ä½ï¼šç§’ï¼‰,
              åªæœ‰ç»è¿‡è¯¥æ—¶é—´åæ‰ä¼šè¿›è¡Œæ–°ä¸€è½®çš„æ•°æ®æŸ¥è¯¢</span>

            <div class="input">
              <label>å®æ—¶è·å–æ•°æ®</label>
              <div id="real_time_cache_favorite" class="btn-group">
                <div class="checkbox">
                  <input type="radio" id="real_time_cache_favorite_true" name="real_time_cache_favorite" value="true" />
                  <label for="real_time_cache_favorite_true">æ˜¯</label>
                </div>
                <div class="checkbox">
                  <input type="radio" id="real_time_cache_favorite_false" name="real_time_cache_favorite"
                    value="false" />
                  <label for="real_time_cache_favorite_false">å¦</label>
                </div>
              </div>
            </div>
            <span class="setting-desc">å¼€å¯æ­¤é€‰é¡¹åï¼Œæ¯æ¬¡è¿›å…¥ä¸»é¡µæ—¶ï¼Œéƒ½ä¼šå¯¹æ‰€æœ‰å·²æ”¶è—(æ ‡æ˜Ÿ)å°ç­è¿›è¡Œä¸€æ¬¡å®æ—¶æŸ¥è¯¢, æ–¹ä¾¿å®æ—¶è§‚å¯Ÿæ‰“å¡æ•°æ®å˜åŒ–</span>

            <div class="input">
              <label for="daily_record_input">è®°å½•å®šæ—¶ä»»åŠ¡</label>
              <input id="daily_record_input" type="text" />
            </div>
            <span class="setting-desc">å³æ¯æ—¥å®šæ—¶ä¿å­˜æ•°æ®çš„æ—¶é—´, é»˜è®¤ä¸ºâ€œ59 23 * * *â€, å³æ¯æ™š23ç‚¹59åˆ†ä¿å­˜æ•°æ®, å…·ä½“è¯­æ³•è¯·å‚è€ƒ[Crontab],
              æ­¤å¤„ä¿®æ”¹ä¸ä¼šç«‹åˆ»ç”Ÿæ•ˆï¼Œè¯·è”ç³»ç®¡ç†å‘˜é‡å¯åº”ç”¨</span>

            <div class="input">
              <label for="main_token_input">ä¸»æˆæƒä»¤ç‰Œ</label>
              <input id="main_token_input" type="text" />
            </div>
            <span class="setting-desc"><strong>éå¸¸é‡è¦!</strong> æœ¬ç¨‹åºç”¨ä»¥è·å–æ‰€æœ‰åŸºç¡€æ•°æ®çš„æˆæƒä»¤ç‰Œï¼Œå»ºè®®è¯¥ç”¨æˆ·ä¸åº”åŠ å…¥ä»»ä½•å°ç­</span>

            <div class="input">
              <label for="output_file_input">ä¸‹è½½æ–‡ä»¶å</label>
              <input id="output_file_input" type="text" />
            </div>
            <span class="setting-desc">åœ¨[æ•°æ®æŸ¥è¯¢]é¡µé¢æŸ¥è¯¢å¾—åˆ°ç»“æœå,ç‚¹å‡»ä¸‹è½½è·å–çš„è¡¨æ ¼æ–‡ä»¶çš„æ–‡ä»¶å</span>

            <div class="btn-group">
              <div id="save_btn" class="btn" onclick="saveConfig()">ä¿å­˜</div>
            </div>
          </div>
          <div class="disclaimer">
            <h1>å…è´£å£°æ˜</h1>
            <p>æ„Ÿè°¢æ‚¨é€‰æ‹©ä½¿ç”¨æœ¬å°ç­æ•°æ®ç®¡ç†å™¨ã€‚åœ¨ä½¿ç”¨æœ¬ç¨‹åºä¹‹å‰, è¯·æ‚¨<strong>ä»”ç»†é˜…è¯»</strong>å¹¶ç†è§£ä»¥ä¸‹å…è´£å£°æ˜å†…å®¹ï¼š

              1. æœ¬ç¨‹åºåŸºäº[GPLv3]å¼€æºï¼Œä»…ä¾›ä¸ªäººå­¦ä¹ ã€ç ”ç©¶å’Œå…¶ä»–éå•†ä¸šæ€§è´¨çš„åˆæ³•ç”¨é€”, ä»»ä½•å› è¿åç›¸å…³æ³•å¾‹æ³•è§„æˆ–ä¾µçŠ¯ä»–äººæƒç›Šæ‰€å¯¼è‡´çš„æ³•å¾‹è´£ä»», ç”±ç”¨æˆ·è‡ªè¡Œæ‰¿æ‹…ã€‚
              2. ç”¨æˆ·åœ¨ä½¿ç”¨æœ¬ç¨‹åºæ—¶, åº”éµå®ˆæ‰€åœ¨å›½å®¶æˆ–åœ°åŒºçš„æ³•å¾‹æ³•è§„, å¹¶å¯¹ä½¿ç”¨è¯¥ç¨‹åºäº§ç”Ÿçš„ä¸€åˆ‡åæœè´Ÿå…¨éƒ¨è´£ä»»ã€‚
              3. æœ¬ç¨‹åºå¯¹äºç”¨æˆ·ä½¿ç”¨è¿‡ç¨‹ä¸­å¯èƒ½äº§ç”Ÿçš„å„ç§é£é™©ï¼ˆåŒ…æ‹¬ä½†ä¸é™äºè¢«æ•°æ®æ¥æºå…¬å¸çš„å°ç¦ã€ç”¨æˆ·è‡ªèº«åˆè§„é—®é¢˜ç­‰ï¼‰ä¸æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚
              4. ç”¨æˆ·è¿åæœ¬å£°æ˜æˆ–è€…æ»¥ç”¨æœ¬ç¨‹åºè¿›è¡Œéæ³•æ´»åŠ¨çš„, æ•°æ®æ¥æºå…¬å¸å°†æœ‰æƒè¿½ç©¶æ‚¨çš„æ³•å¾‹è´£ä»»ã€‚
              5. æœ¬ç¨‹åºä½œè€…å¯¹ç”¨æˆ·ä½¿ç”¨æœ¬ç¨‹åºäº§ç”Ÿçš„ä¸€åˆ‡çº çº·ã€æŸå¤±æˆ–ä¼¤å®³ä¸æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚
              6. ä¸€æ—¦ç”¨æˆ·å¼€å§‹ä½¿ç”¨æœ¬ç¨‹åº, åˆ™è§†ä¸ºç”¨æˆ·å·²å……åˆ†ç†è§£å¹¶åŒæ„æœ¬å…è´£å£°æ˜çš„å…¨éƒ¨å†…å®¹, å¦‚æœæ‚¨æ— æ³•æ¥å—ä¸Šè¿°æ¡æ¬¾, è¯·<strong>ç«‹å³åœæ­¢</strong>ä½¿ç”¨æœ¬ç¨‹åºã€‚</p>
          </div>
        </div>
      </div>
      <div class="wall-container group-detail-page hide" id="group-detail-page">

        <div class="group-info-container"></div>
        <div class="paper">
          <div class="member-info-container hide">
            <div class="input-group">
              <div class="input">
                <label for="week_select">å‘¨æ•°</label>
                <select id="week_select" onkeyup="eventSearch(event)"></select>
              </div>
              <div class="input wrap-input">
                <label for="display_left">å±•ç¤ºå·²ç¦»å¼€æˆå‘˜</label>
                <div id="display_left" class="btn-group">
                  <div class="checkbox">
                    <input type="radio" id="display_left_true" name="display_left" value="true"/>
                    <label for="display_left_true">æ˜¯</label>
                  </div>
                  <div class="checkbox">
                    <input type="radio" id="display_left_false" name="display_left" value="false" checked />
                    <label for="display_left_false">å¦</label>
                  </div>
                </div>
              </div>
              <div class="input wrap-input">
                <label for="display_type">å±•ç¤ºç±»å‹</label>
                <div id="display_type" class="btn-group">
                  <div class="checkbox">
                    <input type="checkbox" id="display_cheat" checked />
                    <label for="display_cheat">ä½œå¼Š</label>
                  </div>
                  <div class="checkbox">
                    <input type="checkbox" id="display_late" checked />
                    <label for="display_late">æ™šå¡</label>
                  </div>
                  <div class="checkbox">
                    <input type="checkbox" id="display_absence" checked />
                    <label for="display_absence">ç¼ºå¡</label>
                  </div>
                  <div class="checkbox">
                    <input type="checkbox" id="display_all" />
                    <label for="display_all">å…¨å‘˜</label>
                  </div>
                </div>
              </div>
              <div class="btn-group">
                <div id="search_btn" class="btn" onclick="queryGroupDetails()">æŸ¥è¯¢</div>
                <div id="setting_btn" class="btn" onclick="toggleSettingModal()">è®¾ç½®</div>
                <div id="filter_btn" class="btn" onclick="toggleFilterModal()">å¯åŠ¨ç­›é€‰</div>
              </div>
            </div>
            <div id="member_filter" class="search-input hide">
              <span>ğŸ”</span>
              <input type="text" placeholder="ç­›é€‰ç”¨æˆ·" onkeyup="memberFilter(event)" />
            </div>
            <div class="details-container"></div>
          </div>
          <span class="loading-text">
            <div class="loader">
              <span></span>
              <span></span>
              <span></span>
            </div>
            æ•°æ®è·å–ä¸­ï¼Œè¯·ç¨å...
          </span>
        </div>
        <div class="paper filter-log-container">
          <div class="table">
            <div class="table-page">
              <div class="filter-page-button" style="display: flex;">
                <div class="btn" onclick="queryFilterLog('1')">&lt;&lt;</div> 
                <div class="btn" onclick="queryFilterLog('-')">&lt;</div>
                <div class="filter-page-num">1/1</div>
                <div class="btn" onclick="queryFilterLog('+')">&gt;</div>
                <div class="btn" onclick="queryFilterLog('-1')">&gt;&gt;</div>
              </div>
              <select id="filter-page-count">
                <option value="20">20æ¡/é¡µ</option>
                <option value="50">50æ¡/é¡µ</option>
                <option value="100">100æ¡/é¡µ</option>
                <option value="200">200æ¡/é¡µ</option>
                <option value="500">500æ¡/é¡µ</option>
                <option value="2000">2000æ¡/é¡µ</option>
              </select>
            </div>
            <div class="table-content">
              <table id="filter_log_table">
              </table>
            </div>
          </div>
        </div>
      </div>
      <div id="setting_modal" class="modal hide" data-status="hidden" onclick="toggleSettingModal(event)">
        <div class="modal-content">
          <span class="modal-close-btn" onclick="toggleSettingModal()"></span>
          <div class="modal-title">å°ç­è®¾ç½®</div>
          <div class="modal-body">
            <div class="setting-group">
              <div class="input">
                <label>æ¯æ—¥è®°å½•å¼€å…³</label>
                <div id="record_select" class="btn-group">
                  <div class="checkbox">
                    <input type="radio" id="record_select_true" name="record_select" value="1" />
                    <label for="record_select_true">å¼€å¯</label>
                  </div>
                  <div class="checkbox">
                    <input type="radio" id="record_select_false" name="record_select" value="0" />
                    <label for="record_select_false">å…³é—­</label>
                  </div>
                </div>
              </div>
              <div class="input">
                <label for="late_time_input">æ™šå¡æ—¶é—´</label>
                <input type="time" id="late_time_input" />
              </div>
              <div class="input">
                <label for="auth_token_input">æˆæƒä»¤ç‰Œ</label>
                <input type="text" id="auth_token_input" />
              </div>
              <div class="input-group">
                <div id="search_btn" class="btn" onclick="saveConfig()">ä¿å­˜è®¾ç½®</div>
                <div id="delete_btn" class="btn red-border" onclick="deleteGroup()">åˆ é™¤å°ç­</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="wall-container strategy-page hide" id="strategy-page" style="background: transparent; border: none;">
        <div class="blackboard" style="flex-direction: row;
          display: flex;">
          <span class="gloss"></span>
          <span class="eraser" onclick="slideLeft(event)"></span>
          <div class="strategy-list" style="width:30%;"></div>
          <div class="strategy-info" style="width:70%;"></div>
        </div>
        <div class="strategy-detail"></div>
        
      </div>
    </div>
    </div>
  </main>


  <div class="footer">
    <footer>
      <div class="info">
        <input type="checkbox">
        <span></span>
        <span></span>
        <span></span>
        <div>
          <span><a href="https://github.com/shadlc/BCZ-Group-Manager" target="_blank"><u>BCZ-Group-Manager</u></a> Made
            By Shadlc&Cerenilla</span>
        </div>
      </div>
    </footer>
  </div>
  <div id="refresh_btn" class="left-corner-btn btn" onclick="refresh_data()">åˆ·æ–°</div>
  <div id="group_search_modal" class="modal hide" data-status="hidden" onclick="toggleGroupSearchModal(event)">
    <div class="modal-content">
      <span class="modal-close-btn" onclick="toggleGroupSearchModal()"></span>
      <div class="modal-title">æ·»åŠ å°ç­</div>
      <div class="modal-body">
        <div id="group_search">
          <input type="text" id="group_search_input" placeholder="ç­é•¿IDæˆ–16ä½å°ç­åˆ†äº«ç (é6ä½é‚€è¯·ç )" onkeyup="eventSearch(event)">
          <span class="btn" onclick="searchGroups()">æœç´¢</span>
        </div>
        <div id="group_result">
          <span>ç©ºç©ºå¦‚ä¹Ÿ~</span>
        </div>
      </div>
    </div>
  </div>
  <style>
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  </style>
  <script src="lib/script.js"></script>
  <script src="lib/group.js"></script>
  <script src="lib/data.js"></script>
  <script src="lib/setting.js"></script>
  <script src="lib/group_details.js"></script>
  <script src="lib/switch_box.js"></script>
  <script src="lib/jquery-3.5.1.min.js"></script>
  <script src="lib/notice_card.js"></script>
  <!-- <script src="lib/notice_card_without_jquery.js"></script> -->
  <script src="lib/strategy.js"></script>
  <script>
    var group_loaded = false;
    var data_loaded = false;
    var setting_loaded = false;
    var strategy_loaded = false;
    //DOMåŠ è½½å®Œæˆåæ‰§è¡ŒgroupPage()å‡½æ•°
    window.onload = function () {
      initCloud(30);
      groupPage();
      // å»ºç«‹åˆ°/testçš„sseè¿æ¥
      const source = new EventSource('/message');
      source.onmessage = function (event) {
        const data = event.data.split('#');
        const messageObject = {};

        data.forEach(line => {
          const [key, value] = line.split('$');
          if (key && value) {
            messageObject[key] = value;
          }
        });
        // å°†ä»¥ä¸Šæ‰€æœ‰å€¼è½¬æ¢æˆå­—ç¬¦ä¸²
        const card_message = messageObject['name'] + messageObject['message'];
        $newCard(card_message)
      };
      bindScrollToTopBtn(document.querySelector("main"));
    }
    function groupPage() {
      // document.getElementsByClassName("group-page")[0].style.display = "block";
      document.getElementById("group_button").classList.add("active");
      document.getElementById("data_button").classList.remove("active");
      document.getElementById("setting_button").classList.remove("active");
      document.getElementById("strategy_button").classList.remove("active");
      SwitchRight('group-page')
      if (!group_loaded) {
        group_loaded = true;
        initGroupPage();
      }
    }
    function dataPage() {
      // document.getElementsByClassName("data-page")[0].style.display = "block";
      document.getElementById("group_button").classList.remove("active");
      document.getElementById("data_button").classList.add("active");
      document.getElementById("setting_button").classList.remove("active");
      document.getElementById("strategy_button").classList.remove("active");
      SwitchRight('data-page')
      if (!data_loaded) {
        data_loaded = true;
        initDataPage();
      }
    }
    function settingPage() {
      document.getElementById("group_button").classList.remove("active");
      document.getElementById("data_button").classList.remove("active");
      document.getElementById("setting_button").classList.add("active");
      document.getElementById("strategy_button").classList.remove("active");
      SwitchRight('setting-page')
      if (!setting_loaded) {
        setting_loaded = true;
        initSettingPage();
      }
    }
    function strategyPage(){
      document.getElementById("group_button").classList.remove("active");
      document.getElementById("data_button").classList.remove("active");
      document.getElementById("setting_button").classList.remove("active");
      document.getElementById("strategy_button").classList.add("active");
      SwitchRight('strategy-page')
      if (!strategy_loaded) {
        strategy_loaded = true;
        initStrategyPage();
      }
    }

  </script>

</body>

</html>